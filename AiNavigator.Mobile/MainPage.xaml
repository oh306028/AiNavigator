<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             xmlns:local="clr-namespace:AiNavigator.Mobile"
             xmlns:converters="clr-namespace:AiNavigator.Mobile.Converters"
             xmlns:models="clr-namespace:AiNavigator.Mobile.Models"
             x:Class="AiNavigator.Mobile.MainPage"
             BackgroundColor="#F8FAFC">

    <ContentPage.Resources>
        <ResourceDictionary>
            <converters:StringListConverter x:Key="StringListConverter" />


            <Color x:Key="PrimaryColor">#6366F1</Color>
            <Color x:Key="PrimaryDarkColor">#4F46E5</Color>
            <Color x:Key="SecondaryColor">#10B981</Color>
            <Color x:Key="AccentColor">#F59E0B</Color>
            <Color x:Key="BackgroundColor">#F8FAFC</Color>
            <Color x:Key="SurfaceColor">#FFFFFF</Color>
            <Color x:Key="TextPrimaryColor">#1F2937</Color>
            <Color x:Key="TextSecondaryColor">#6B7280</Color>
            <Color x:Key="BorderColor">#E5E7EB</Color>
            <Color x:Key="SuccessColor">#059669</Color>
            <Color x:Key="ErrorColor">#DC2626</Color>
            <Color x:Key="ShadowColor">#00000020</Color>


            <LinearGradientBrush x:Key="HeaderGradient" StartPoint="0,0" EndPoint="1,1">
                <GradientStop Color="#6366F1" Offset="0"/>
                <GradientStop Color="#8B5CF6" Offset="1"/>
            </LinearGradientBrush>

            <LinearGradientBrush x:Key="ButtonGradient" StartPoint="0,0" EndPoint="1,1">
                <GradientStop Color="#6366F1" Offset="0"/>
                <GradientStop Color="#4F46E5" Offset="1"/>
            </LinearGradientBrush>


            <Style x:Key="HeaderLabelStyle" TargetType="Label">
                <Setter Property="FontSize" Value="28"/>
                <Setter Property="FontAttributes" Value="Bold"/>
                <Setter Property="TextColor" Value="White"/>
                <Setter Property="HorizontalOptions" Value="Center"/>
                <Setter Property="Margin" Value="0,10,0,20"/>
            </Style>

            <Style x:Key="SectionTitleStyle" TargetType="Label">
                <Setter Property="FontSize" Value="18"/>
                <Setter Property="FontAttributes" Value="Bold"/>
                <Setter Property="TextColor" Value="{StaticResource TextPrimaryColor}"/>
                <Setter Property="Margin" Value="0,0,0,10"/>
            </Style>

            <Style x:Key="PrimaryButtonStyle" TargetType="Button">
                <Setter Property="Background" Value="{StaticResource ButtonGradient}"/>
                <Setter Property="TextColor" Value="White"/>
                <Setter Property="FontSize" Value="16"/>
                <Setter Property="FontAttributes" Value="Bold"/>
                <Setter Property="CornerRadius" Value="12"/>
                <Setter Property="HeightRequest" Value="50"/>
                <Setter Property="Shadow">
                    <Shadow Brush="{StaticResource ShadowColor}" 
                            Offset="0,4" 
                            Radius="8"/>
                </Setter>
            </Style>

            <Style x:Key="CardFrameStyle" TargetType="Frame">
                <Setter Property="BackgroundColor" Value="{StaticResource SurfaceColor}"/>
                <Setter Property="BorderColor" Value="Transparent"/>
                <Setter Property="CornerRadius" Value="16"/>
                <Setter Property="Padding" Value="20"/>
                <Setter Property="Margin" Value="0,8,0,8"/>
                <Setter Property="HasShadow" Value="False"/>
                <Setter Property="Shadow">
                    <Shadow Brush="{StaticResource ShadowColor}" 
                            Offset="0,2" 
                            Radius="12"/>
                </Setter>
            </Style>

            <Style x:Key="ModelNameStyle" TargetType="Label">
                <Setter Property="FontSize" Value="20"/>
                <Setter Property="FontAttributes" Value="Bold"/>
                <Setter Property="TextColor" Value="{StaticResource TextPrimaryColor}"/>
            </Style>

            <Style x:Key="RankBadgeStyle" TargetType="Frame">
                <Setter Property="BackgroundColor" Value="{StaticResource PrimaryColor}"/>
                <Setter Property="CornerRadius" Value="12"/>
                <Setter Property="Padding" Value="8,4"/>
                <Setter Property="HasShadow" Value="False"/>
                <Setter Property="VerticalOptions" Value="Center"/>
            </Style>

            <Style x:Key="RankTextStyle" TargetType="Label">
                <Setter Property="TextColor" Value="White"/>
                <Setter Property="FontSize" Value="12"/>
                <Setter Property="FontAttributes" Value="Bold"/>
            </Style>

            <Style x:Key="ProsHeaderStyle" TargetType="Label">
                <Setter Property="FontAttributes" Value="Bold"/>
                <Setter Property="TextColor" Value="{StaticResource SuccessColor}"/>
                <Setter Property="FontSize" Value="14"/>
            </Style>

            <Style x:Key="ConsHeaderStyle" TargetType="Label">
                <Setter Property="FontAttributes" Value="Bold"/>
                <Setter Property="TextColor" Value="{StaticResource ErrorColor}"/>
                <Setter Property="FontSize" Value="14"/>
            </Style>
        </ResourceDictionary>
    </ContentPage.Resources>

    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
        </Grid.RowDefinitions>

       
        <Frame Grid.Row="0" 
               Background="{StaticResource HeaderGradient}"
               CornerRadius="24"
               Padding="20,40,20,30"
               HasShadow="False">
            <VerticalStackLayout Spacing="20">
                <Label Text="🤖 AI Navigator" 
                       Style="{StaticResource HeaderLabelStyle}"/>

                <Label Text="Znajdź idealny model AI dla swoich potrzeb"
                       FontSize="16"
                       TextColor="White"
                       HorizontalOptions="Center"
                       Opacity="0.9"/>
            </VerticalStackLayout>
        </Frame>


        <ScrollView Grid.Row="1" Margin="20,20,20,0">
            <VerticalStackLayout Spacing="20">

                <Frame Style="{StaticResource CardFrameStyle}">
                    <VerticalStackLayout Spacing="15">
                        <HorizontalStackLayout Spacing="10">
                            <Label Text="📂" FontSize="20" VerticalOptions="Center"/>
                            <Label Text="Wybierz kategorię" 
                                   Style="{StaticResource SectionTitleStyle}"
                                   VerticalOptions="Center"/>
                        </HorizontalStackLayout>

                        <Frame BackgroundColor="{StaticResource BackgroundColor}"
                               BorderColor="{StaticResource BorderColor}"
                               CornerRadius="12"
                               Padding="0"
                               HasShadow="False">
                            <Picker x:Name="CategoryPicker"
                                    Title="Wybierz kategorię modeli AI"
                                    FontSize="16"
                                    TextColor="{StaticResource TextPrimaryColor}"
                                    TitleColor="{StaticResource TextSecondaryColor}"
                                    Margin="15,0">
                                <Picker.ItemsSource>
                                    <x:Array Type="{x:Type models:Category}">
                                        <x:Static Member="models:Category.Text" />
                                        <x:Static Member="models:Category.Video" />
                                        <x:Static Member="models:Category.Development" />
                                        <x:Static Member="models:Category.Graphics" />
                                        <x:Static Member="models:Category.Agents" />
                                    </x:Array>
                                </Picker.ItemsSource>
                            </Picker>
                        </Frame>

                        <Button Text="🚀 Znajdź modele AI"
                                Clicked="OnSendPromptClicked"
                                Style="{StaticResource PrimaryButtonStyle}"/>
                    </VerticalStackLayout>
                </Frame>

                <Frame Style="{StaticResource CardFrameStyle}">
                    <VerticalStackLayout Spacing="10">
                        <HorizontalStackLayout Spacing="10">
                            <Label Text="💡" FontSize="18" VerticalOptions="Center"/>
                            <Label Text="Podsumowanie" 
                                   Style="{StaticResource SectionTitleStyle}"
                                   VerticalOptions="Center"/>
                        </HorizontalStackLayout>

                        <Label x:Name="SummaryLabel"
                               FontSize="15"
                               TextColor="{StaticResource TextSecondaryColor}"
                               LineBreakMode="WordWrap"/>
                    </VerticalStackLayout>
                </Frame>

                <StackLayout x:Name="ModelsSection">
                    <HorizontalStackLayout Spacing="10" Margin="0,0,0,15">
                        <Label Text="🏆" FontSize="20" VerticalOptions="Center"/>
                        <Label Text="Rekomendowane modele" 
                               Style="{StaticResource SectionTitleStyle}"
                               VerticalOptions="Center"/>
                    </HorizontalStackLayout>

                    <CollectionView x:Name="ModelsCollection"
                                    BackgroundColor="Transparent">
                        <CollectionView.ItemTemplate>
                            <DataTemplate>
                                <Frame Style="{StaticResource CardFrameStyle}">
                                    <VerticalStackLayout Spacing="15">

                                        <Grid ColumnDefinitions="Auto,*,Auto" ColumnSpacing="15">
                                            <Frame Grid.Column="0" 
                                                   Style="{StaticResource RankBadgeStyle}">
                                                <Label Text="{Binding Rank, StringFormat='#{0}'}" 
                                                       Style="{StaticResource RankTextStyle}"/>
                                            </Frame>

                                            <Label Grid.Column="1" 
                                                   Text="{Binding Name}" 
                                                   Style="{StaticResource ModelNameStyle}"
                                                   VerticalOptions="Center"/>
                                        </Grid>

                                        <Label Text="{Binding ShortDescription}" 
                                               FontSize="15" 
                                               TextColor="{StaticResource TextSecondaryColor}" 
                                               LineBreakMode="WordWrap"/>

                                        <BoxView HeightRequest="1" 
                                                 Color="{StaticResource BorderColor}" 
                                                 Margin="0,5,0,5"/>


                                        <VerticalStackLayout Spacing="8">
                                            <HorizontalStackLayout Spacing="8">
                                                <Label Text="✅" FontSize="16"/>
                                                <Label Text="Zalety:" Style="{StaticResource ProsHeaderStyle}"/>
                                            </HorizontalStackLayout>

                                            <Frame BackgroundColor="#F0FDF4"
                                                   BorderColor="#BBF7D0"
                                                   CornerRadius="8"
                                                   Padding="12"
                                                   HasShadow="False">
                                                <Label Text="{Binding Pros, Converter={StaticResource StringListConverter}}" 
                                                       FontSize="14" 
                                                       TextColor="{StaticResource SuccessColor}"
                                                       LineBreakMode="WordWrap"/>
                                            </Frame>
                                        </VerticalStackLayout>


                                        <VerticalStackLayout Spacing="8">
                                            <HorizontalStackLayout Spacing="8">
                                                <Label Text="⚠️" FontSize="16"/>
                                                <Label Text="Wady:" Style="{StaticResource ConsHeaderStyle}"/>
                                            </HorizontalStackLayout>

                                            <Frame BackgroundColor="#FEF2F2"
                                                   BorderColor="#FECACA"
                                                   CornerRadius="8"
                                                   Padding="12"
                                                   HasShadow="False">
                                                <Label Text="{Binding Cons, Converter={StaticResource StringListConverter}}" 
                                                       FontSize="14" 
                                                       TextColor="{StaticResource ErrorColor}"
                                                       LineBreakMode="WordWrap"/>
                                            </Frame>
                                        </VerticalStackLayout>

                                        <BoxView HeightRequest="1" 
                                                 Color="{StaticResource BorderColor}" 
                                                 Margin="0,5,0,5"/>

                                        <Frame BackgroundColor="{StaticResource BackgroundColor}"
                                               BorderColor="{StaticResource BorderColor}"
                                               CornerRadius="8"
                                               Padding="12"
                                               HasShadow="False">
                                            <HorizontalStackLayout Spacing="8">
                                                <Label Text="🔗" FontSize="16" VerticalOptions="Center"/>
                                                <Label Text="{Binding Link}" 
                                                       TextColor="{StaticResource PrimaryColor}" 
                                                       FontSize="14" 
                                                       TextDecorations="Underline"
                                                       VerticalOptions="Center"
                                                       LineBreakMode="TailTruncation"
                                                       HorizontalOptions="FillAndExpand">
                                                    <Label.GestureRecognizers>
                                                        <TapGestureRecognizer 
                                                            Command="{Binding Source={RelativeSource AncestorType={x:Type ContentPage}}, Path=OpenLinkCommand}" 
                                                            CommandParameter="{Binding Link}" />
                                                    </Label.GestureRecognizers>
                                                </Label>
                                            </HorizontalStackLayout>
                                        </Frame>
                                    </VerticalStackLayout>
                                </Frame>
                            </DataTemplate>
                        </CollectionView.ItemTemplate>
                    </CollectionView>
                </StackLayout>

                <BoxView HeightRequest="20" Color="Transparent"/>
            </VerticalStackLayout>
        </ScrollView>
    </Grid>
</ContentPage>