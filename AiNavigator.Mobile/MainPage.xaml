<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             xmlns:local="clr-namespace:AiNavigator.Mobile"
             xmlns:converters="clr-namespace:AiNavigator.Mobile.Converters"
             xmlns:models="clr-namespace:AiNavigator.Mobile.Models"
             x:Class="AiNavigator.Mobile.MainPage"
             Title="AI Navigator">

    <ContentPage.Resources>
        <converters:StringListConverter x:Key="StringListConverter" />
    </ContentPage.Resources>

    <ScrollView>
        <VerticalStackLayout Padding="20" Spacing="15">

            <Label Text="Wybierz kategorię modeli AI"
                   FontSize="20"
                   HorizontalOptions="Center"
                   FontAttributes="Bold"/>

            <Picker x:Name="CategoryPicker"
                    Title="Wybierz kategorię"
                    FontSize="16"
                    HorizontalOptions="FillAndExpand">
                <Picker.ItemsSource>
                    <x:Array Type="{x:Type models:Category}">
                        <x:Static Member="models:Category.Text" />
                        <x:Static Member="models:Category.Video" />
                        <x:Static Member="models:Category.Development" />
                        <x:Static Member="models:Category.Graphics" />
                        <x:Static Member="models:Category.Agents" />
                    </x:Array>
                </Picker.ItemsSource>
            </Picker>

            <Button Text="Wyślij zapytanie"
                    Clicked="OnSendPromptClicked"
                    BackgroundColor="DeepSkyBlue"
                    TextColor="White"
                    CornerRadius="10"/>

            <Label x:Name="SummaryLabel"
                   FontSize="16"
                   TextColor="DarkBlue"
                   Margin="0,10,0,0"
                   LineBreakMode="WordWrap"/>


            <CollectionView x:Name="ModelsCollection"
                            Margin="0,10,0,0"
                            HeightRequest="800">

                <CollectionView.ItemTemplate>
                    <DataTemplate>
                        <Frame BorderColor="LightGray"
                               CornerRadius="10"
                               Padding="15"
                               Margin="0,5,0,5"
                               HasShadow="True">
                            <VerticalStackLayout Spacing="5">
                                <HorizontalStackLayout Spacing="10">
                                    <Label Text="{Binding Rank, StringFormat='Rank: {0}'}" 
                                           FontAttributes="Bold" 
                                           TextColor="Gray" 
                                           FontSize="12"/>
                                    <Label Text="{Binding Name}" 
                                           FontSize="20" 
                                           FontAttributes="Bold" 
                                           TextColor="Black"/>
                                </HorizontalStackLayout>

                                <Label Text="{Binding ShortDescription}" 
                                       FontSize="14" 
                                       TextColor="DarkGray" 
                                       LineBreakMode="WordWrap"/>

                                <BoxView HeightRequest="1" Color="LightGray" Margin="0,5,0,5"/>

                                <Label Text="Zalety:" FontAttributes="Bold" TextColor="Green"/>
                                <Label Text="{Binding Pros, Converter={StaticResource StringListConverter}}" 
                                       FontSize="14" TextColor="Green"/>

                                <Label Text="Wady:" FontAttributes="Bold" TextColor="Red"/>
                                <Label Text="{Binding Cons, Converter={StaticResource StringListConverter}}" 
                                       FontSize="14" TextColor="Red"/>

                                <BoxView HeightRequest="1" Color="LightGray" Margin="0,5,0,5"/>

                                <Label Text="{Binding Link}" 
                                       TextColor="Blue" 
                                       FontSize="12" 
                                       TextDecorations="Underline">
                                    <Label.GestureRecognizers>
                                        <TapGestureRecognizer 
                                            Command="{Binding Source={RelativeSource AncestorType={x:Type ContentPage}}, Path=OpenLinkCommand}" 
                                            CommandParameter="{Binding Link}" />
                                    </Label.GestureRecognizers>
                                </Label>
                            </VerticalStackLayout>
                        </Frame>
                    </DataTemplate>
                </CollectionView.ItemTemplate>
            </CollectionView>
        </VerticalStackLayout>
    </ScrollView>
</ContentPage>
